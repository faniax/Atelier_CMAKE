Test_Car:
  runs-on: ubuntu-latest
  needs: Compilation
  steps:
    - name: Checkout repository
      uses: actions/checkout@v4

    - name: Run test "car" and capture report
      run: |
        cd build
        echo '== Test car 5 ==' > report_car.txt
        ./calculator car 5 > output_car.txt
        exit_code=$?
        cat output_car.txt >> report_car.txt
        echo "" >> report_car.txt
        echo "Exit code: $exit_code" >> report_car.txt

    - name: Upload report as artifact
      uses: actions/upload-artifact@v4
      with:
        name: test-car-report
        path: build/report_car.txt

    - name: Job summary
      run: |
        echo '### RÃ©sultat du test car' >> $GITHUB_STEP_SUMMARY
        echo '' >> $GITHUB_STEP_SUMMARY
        echo '```' >> $GITHUB_STEP_SUMMARY
        cat build/report_car.txt >> $GITHUB_STEP_SUMMARY
        echo '```' >> $GITHUB_STEP_SUMMARY
